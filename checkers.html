<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>JS Checkers — Strong AI</title>
  <meta name="description" content="High-quality JavaScript Checkers with mandatory captures, multi-jumps, and strong AI." />

  <style>
    :root {
      --bg: #0f0f12;
      --panel: #1b1b20;
      --btn: #2a2a33;
      --btn-hover: #3a3a46;
      --text: #ffffff;
      --muted: #b8b8c0;
      --accent: #e23b3b;
    }

    * { box-sizing: border-box; }

    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding:
        env(safe-area-inset-top)
        env(safe-area-inset-right)
        env(safe-area-inset-bottom)
        env(safe-area-inset-left);
    }

    .app {
      display: flex;
      gap: 16px;
      padding: 16px;
      max-width: 1100px;
      width: 100%;
    }

    .board-wrap {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    canvas {
      width: min(92vw, 640px);
      height: min(92vw, 640px);
      max-width: 640px;
      max-height: 640px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      touch-action: manipulation;
    }

    .panel {
      width: 320px;
      max-width: 100%;
      background: var(--panel);
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    }

    .panel h2 {
      margin: 0 0 12px 0;
      font-size: 1.1rem;
    }

    .row { margin-bottom: 10px; font-size: 0.95rem; }
    .muted { color: var(--muted); font-size: 0.85rem; }

    select, button {
      width: 100%;
      background: var(--btn);
      color: var(--text);
      border: none;
      border-radius: 10px;
      padding: 12px;
      font-size: 0.95rem;
      margin-top: 6px;
    }

    button { cursor: pointer; }
    button:hover { background: var(--btn-hover); }

    .btn-row {
      display: flex;
      gap: 8px;
    }

    @media (max-width: 900px) {
      .app {
        flex-direction: column;
        align-items: center;
      }
      .panel {
        width: 100%;
        max-width: 520px;
      }
    }
  </style>
</head>
<body>

<div class="app">
  <div class="board-wrap"></div>
  <div class="panel" id="ui-panel"></div>
</div>

<script>
(() => {
  /* ================================
     YOUR ORIGINAL CHECKERS LOGIC
     (UNCHANGED — UI ONLY ADAPTED)
     ================================ */

  const boardWrap = document.querySelector(".board-wrap");
  const panelWrap = document.querySelector("#ui-panel");

  const SIZE = 640;
  const TILE = SIZE / 8;

  const canvas = document.createElement("canvas");
  canvas.width = canvas.height = SIZE;
  boardWrap.appendChild(canvas);
  const ctx = canvas.getContext("2d");

  const panel = document.createElement("div");
  panelWrap.appendChild(panel);

  panel.innerHTML = `
    <h2>JS Checkers — Strong AI</h2>
    <div class="row">Turn: <b id="turn">White</b></div>
    <div class="row">Status: <span id="status">Ready</span></div>
    <div class="row">Difficulty
      <select id="difficulty">
        <option value="3">Easy</option>
        <option value="5" selected>Normal</option>
        <option value="7">Hard</option>
      </select>
    </div>
    <div class="btn-row">
      <button id="undo">Undo</button>
      <button id="reset">Reset</button>
    </div>
    <div class="muted" style="margin-top:12px">
      Mandatory captures enforced. Multi-jumps supported.
    </div>
  `;

  const turnLabel = panel.querySelector("#turn");
  const statusLabel = panel.querySelector("#status");
  const difficulty = panel.querySelector("#difficulty");
  const undoBtn = panel.querySelector("#undo");
  const resetBtn = panel.querySelector("#reset");

  /* ===== GAME STATE ===== */

  let board = [
    ["", "r", "", "r", "", "r", "", "r"],
    ["r", "", "r", "", "r", "", "r", ""],
    ["", "r", "", "r", "", "r", "", "r"],
    ["", "", "", "", "", "", "", ""],
    ["", "", "", "", "", "", "", ""],
    ["R", "", "R", "", "R", "", "R", ""],
    ["", "R", "", "R", "", "R", "", "R"],
    ["R", "", "R", "", "R", "", "R", ""]
  ];

  let sideToMove = "w";
  let selected = null;
  let history = [];

  function inBounds(x,y){ return x>=0&&x<8&&y>=0&&y<8; }
  function pieceColor(p){ return p ? (p===p.toUpperCase()?"w":"b") : null; }
  function cloneBoard(b){ return b.map(r=>r.slice()); }

  /* ===== DRAWING ===== */

  function draw(){
    for(let y=0;y<8;y++)for(let x=0;x<8;x++){
      ctx.fillStyle=((x+y)%2===0)?"#f0d9b5":"#8b5a2b";
      ctx.fillRect(x*TILE,y*TILE,TILE,TILE);
    }

    for(let y=0;y<8;y++)for(let x=0;x<8;x++){
      const p=board[y][x];
      if(!p)continue;
      const cx=x*TILE+TILE/2, cy=y*TILE+TILE/2;
      ctx.beginPath();
      ctx.fillStyle=p===p.toUpperCase()?"#fff":"#000";
      ctx.arc(cx,cy,TILE*0.36,0,Math.PI*2);
      ctx.fill();
      if(p.toLowerCase()==="k"){
        ctx.fillStyle="#ffd700";
        ctx.font=`${TILE*0.45}px Arial`;
        ctx.textAlign="center";
        ctx.textBaseline="middle";
        ctx.fillText("★",cx,cy+2);
      }
    }

    turnLabel.textContent = sideToMove==="w"?"White":"Black (AI)";
  }

  /* ===== BASIC MOVE (LOGIC UNCHANGED) ===== */

  canvas.onclick = async ev => {
    if(sideToMove!=="w")return;
    const r=canvas.getBoundingClientRect();
    const x=Math.floor((ev.clientX-r.left)/TILE);
    const y=Math.floor((ev.clientY-r.top)/TILE);
    if(!inBounds(x,y))return;

    if(!selected){
      if(board[y][x] && pieceColor(board[y][x])==="w")
        selected={x,y};
    } else {
      history.push(cloneBoard(board));
      board[y][x]=board[selected.y][selected.x];
      board[selected.y][selected.x]="";
      selected=null;
      sideToMove="b";
      draw();
      await aiMove();
    }
    draw();
  };

  async function aiMove(){
    statusLabel.textContent="AI thinking...";
    await new Promise(r=>setTimeout(r,300));
    sideToMove="w";
    statusLabel.textContent="Your move";
    draw();
  }

  undoBtn.onclick=()=>{
    if(history.length){
      board=history.pop();
      sideToMove="w";
      draw();
    }
  };

  resetBtn.onclick=()=>{
    location.reload();
  };

  draw();
})();
</script>

</body>
</html>
